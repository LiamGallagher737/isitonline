{% extends "base.html" %}

{% block title %}Home{% endblock %}

{% block content %}

<section id="stats">
  <div class="stat-card start-card-green">
    <p>Online Monitors</p>
    <div class="stat-card-content">
      <div class="stat-card-icon">
        <svg xmlns="http://www.w3.org/2000/svg" height="28" viewBox="0 -960 960 960" width="28"><path d="M382-240 154-468l57-57 171 171 367-367 57 57-424 424Z"/></svg>
      </div>
      <span>{{ online_monitors }}</span>
    </div>
  </div>

  <div class="stat-card start-card-red">
    <p>Offline Monitors</p>
    <div class="stat-card-content">
      <div class="stat-card-icon">
        <svg xmlns="http://www.w3.org/2000/svg" height="28" viewBox="0 -960 960 960" width="28"><path d="M330-120 120-330v-300l210-210h300l210 210v300L630-120H330Zm36-190 114-114 114 114 56-56-114-114 114-114-56-56-114 114-114-114-56 56 114 114-114 114 56 56Zm-2 110h232l164-164v-232L596-760H364L200-596v232l164 164Zm116-280Z"/></svg>
      </div>
      <span>{{ offline_monitors }}</span>
    </div>
  </div>

  <div class="stat-card start-card-orange">
    <p>Warnings</p>
    <div class="stat-card-content">
      <div class="stat-card-icon">
        <svg xmlns="http://www.w3.org/2000/svg" height="28" viewBox="0 -960 960 960" width="28"><path d="m40-120 440-760 440 760H40Zm138-80h604L480-720 178-200Zm302-40q17 0 28.5-11.5T520-280q0-17-11.5-28.5T480-320q-17 0-28.5 11.5T440-280q0 17 11.5 28.5T480-240Zm-40-120h80v-200h-80v200Zm40-100Z"/></svg>
      </div>
      <span>{{ warnings }}</span>
    </div>
  </div>

  <div class="stat-card start-card-blue">
    <p>Average Uptime</p>
    <div class="stat-card-content">
      <div class="stat-card-icon">
        <svg xmlns="http://www.w3.org/2000/svg" height="28" viewBox="0 -960 960 960" width="28"><path d="M440-160v-487L216-423l-56-57 320-320 320 320-56 57-224-224v487h-80Z"/></svg>
      </div>
      <span>{{ average_uptime }}%</span>
    </div>
  </div>
</section>

<section id="issues">
  <h2>Active Issues</h2>

  <div class="issue-cards">
    {% if issues.len() == 0 %}
      No issues
    {% else %}
      {% for IssueTemplate { timestamp, success, http_code, name, target } in issues %}
        {% include "issue.html" %}
      {% endfor %}
    {% endif %}
  </div>
</section>

<section>
  <table class="table-auto w-[700px] text-sm text-left text-gray-700">
    <thead class="text-md text-gray-900 bg-gray-50">
      <tr>
        <th scope="col" class="px-6 py-3">Monitor</th>
        <th scope="col" class="px-6 py-3">Status</th>
        <th scope="col" class="px-6 py-3">Last Check</th>
        <th scope="col" class="px-6 py-3"><span class="sr-only">Actions</span></th>
      </tr>
    </thead>
    <tbody id="monitors" hx-get="/monitors" hx-trigger="every 5s">
      {% include "monitors.html" %}
    </tbody>
  </table>
  
  <form hx-post="/monitor" hx-target="#monitors" hx-swap="beforeend">
    <input id="name" name="name" placeholder="Name" type="text" required />
    <input id="target" name="target" placeholder="https://example.com" type="url" required />
    <input id="cron" name="cron" placeholder="1/20 * * * * *" type="text" required />
    <button type="submit">Submit</button>
  </form>
</section>

{% endblock %}
